---
# Tailscale serve configuration for this host
# Each service maps a Tailscale service name to local endpoints

tailscale_serve_services:
  - name: svc:grafana
    https:
      port: 443
      upstream: http://localhost:3000

  - name: svc:forge
    https:
      port: 443
      upstream: http://localhost:3001
    tcp:
      port: 22
      upstream: tcp://localhost:2200

  - name: svc:kiwix
    https:
      port: 443
      upstream: http://localhost:5501

  - name: svc:pypi
    https:
      port: 443
      upstream: http://127.0.0.1:3141

  - name: svc:pg
    tcp:
      port: 5432
      upstream: tcp://localhost:5432

  - name: svc:feed
    https:
      port: 443
      upstream: http://localhost:8080

  - name: svc:registry
    https:
      port: 443
      upstream: http://localhost:5050

  # Kubernetes API server (TCP passthrough for mTLS)
  # NOTE: Port is dynamic with podman driver - check with:
  #   ssh indri "kubectl config view --minify -o jsonpath='{.clusters[0].cluster.server}'"
  - name: svc:k8s
    tcp:
      port: 443
      upstream: tcp://localhost:44491
