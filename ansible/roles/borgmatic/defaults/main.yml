---
borgmatic_config: /Users/erichblume/.config/borgmatic/config.yaml
borgmatic_config_dir: /Users/erichblume/.config/borgmatic
borgmatic_log_dir: /Users/erichblume/Library/Logs

# Full path to borg binary since LaunchAgent doesn't have homebrew in PATH
borgmatic_local_path: /opt/homebrew/bin/borg

# Schedule: runs daily at 2:00 AM
borgmatic_schedule_hour: 2
borgmatic_schedule_minute: 0

# Source directories to back up
borgmatic_source_directories:
  - /Users/erichblume/code/personal/zk
  - /opt/homebrew/var/forgejo
  - /Users/erichblume/.config/borgmatic
  - /Users/erichblume/Documents
  - /Users/erichblume/Pictures
  - /Users/erichblume/devpi
  - /opt/homebrew/var/loki

# Backup repository
borgmatic_repositories:
  - path: /Volumes/backups/borg/
    label: sifaka-borg-backups
    encryption: repokey
    append_only: true

# Exclude patterns
borgmatic_exclude_patterns:
  # Exclude mirrored PyPI cache (only backup private packages)
  - /Users/erichblume/devpi/+files/root/pypi

# Encryption passcommand (reads borg passphrase)
borgmatic_encryption_passcommand: cat /Users/erichblume/.borg/config.yaml

# Retention policy
borgmatic_keep_daily: 7
borgmatic_keep_monthly: 12
borgmatic_keep_yearly: 1000

# PostgreSQL databases to backup (streamed via pg_dump)
# Password is read from ~/.pgpass (managed by this role)
# pg_dump_command must be full path since LaunchAgent doesn't have homebrew in PATH
borgmatic_pg_dump_command: /opt/homebrew/opt/postgresql@18/bin/pg_dump
borgmatic_postgresql_databases:
  # k8s PostgreSQL (CloudNativePG)
  - name: miniflux
    hostname: pg.tail8d86e.ts.net
    port: 5432
    username: borgmatic
