# Homepage configuration files
# Extracted from former Helm values.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: homepage-config
  namespace: homepage
data:
  bookmarks.yaml: |
    - Admin:
        - Tailscale Admin:
            - href: https://login.tailscale.com/admin
              icon: tailscale
        - 1Password:
            - href: https://my.1password.com
              icon: 1password
        - Pulumi:
            - href: https://app.pulumi.com/eblume/blumeops-tailnet
              icon: si-pulumi
        - ArgoCD:
            - href: https://argocd.ops.eblu.me
              icon: argo-cd
        - UniFi:
            - href: https://unifi.ui.com
              icon: ubiquiti

  services.yaml: |
    - Host Services:
        - Forgejo:
            href: https://forge.ops.eblu.me
            icon: forgejo
            description: Git forge
            widget:
              type: gitea
              url: https://forge.ops.eblu.me
              key: "{{HOMEPAGE_VAR_FORGEJO_API_KEY}}"
        - Registry:
            href: https://registry.ops.eblu.me
            icon: zot-registry
            description: Container registry
        - Sifaka NAS:
            href: https://nas.ops.eblu.me
            icon: synology
            description: NAS dashboard
            widget:
              type: prometheusmetric
              url: https://prometheus.ops.eblu.me
              metrics:
                - label: Used
                  query: node_filesystem_size_bytes{mountpoint="/Volumes/backups"} - node_filesystem_avail_bytes{mountpoint="/Volumes/backups"}
                  format:
                    type: bytes
                - label: Total
                  query: node_filesystem_size_bytes{mountpoint="/Volumes/backups"}
                  format:
                    type: bytes
        - Borgmatic:
            href: https://grafana.ops.eblu.me/d/borgmatic
            icon: borgmatic
            description: Backup system
            widget:
              type: prometheusmetric
              url: https://prometheus.ops.eblu.me
              metrics:
                - label: Last backup
                  query: time() - borgmatic_last_archive_timestamp
                  format:
                    type: duration
                - label: Archive size
                  query: borgmatic_repo_deduplicated_size_bytes
                  format:
                    type: bytes
        - Jellyfin:
            href: https://jellyfin.ops.eblu.me
            icon: jellyfin
            description: Media server
            widget:
              type: jellyfin
              url: https://jellyfin.ops.eblu.me
              key: "{{HOMEPAGE_VAR_JELLYFIN_API_KEY}}"
              enableBlocks: true
              enableNowPlaying: true
        # TODO: Add Caddy widget when admin API is enabled (currently admin off)
        # - Caddy:
        #     href: https://indri.tail8d86e.ts.net
        #     icon: caddy
        #     description: Reverse proxy
        #     widget:
        #       type: caddy
        #       url: http://indri.tail8d86e.ts.net:2019
    - Infrastructure:
        - Authentik:
            href: https://authentik.ops.eblu.me
            icon: authentik
            description: Identity provider
        - NVR:
            href: https://nvr.ops.eblu.me
            icon: frigate.png
            description: Network video recorder
        - Ntfy:
            href: https://ntfy.ops.eblu.me
            icon: ntfy.png
            description: Push notifications

  widgets.yaml: |
    - greeting:
        text_size: xl
        text: Welcome to Blue Mops
    - datetime:
        text_size: lg
        format:
          dateStyle: long
          timeStyle: short
          hour12: true
    - openweathermap:
        label: Camano
        latitude: 48.18235
        longitude: -122.52590
        units: imperial
        provider: openweathermap
        apiKey: "{{HOMEPAGE_VAR_OPENWEATHERMAP_API_KEY}}"
        cache: 15
    # TODO: Add UniFi widget when controller is set up
    # - unifi_console:
    #     url: https://192.168.1.1
    #     username: homepage
    #     password: "{{HOMEPAGE_VAR_UNIFI_PASSWORD}}"
    # TODO: Add Glances widget when Glances is deployed
    # - glances:
    #     url: http://indri.tail8d86e.ts.net:61208
    #     metric: cpu

  kubernetes.yaml: |
    mode: cluster

  docker.yaml: ""

  settings.yaml: |
    title: BlumeOps
    headerStyle: boxed
    quicklaunch:
      searchDescriptions: true
      showSearchSuggestions: true
      provider: custom
      url: https://kagi.com/search?q=
      suggestionUrl: https://kagisuggest.com/api/autosuggest?q=
    layout:
      Host Services:
        style: column
      Content:
        style: column
      Infrastructure:
        style: column
      Services:
        style: column
