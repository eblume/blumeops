#!/usr/bin/env bash
#MISE description="Preview DNS changes to eblu.me with Pulumi"

set -euo pipefail

GANDI_PERSONAL_ACCESS_TOKEN=$(op read "op://blumeops/gandi - blumeops/pat")
export GANDI_PERSONAL_ACCESS_TOKEN

cd "$(dirname "$0")/../pulumi/gandi"
uv sync --quiet || { echo "uv sync failed â€” if devpi is down, run 'devpi off' and retry"; exit 1; }
pulumi stack select eblu-me
pulumi preview "$@"
